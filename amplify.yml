version: 1
applications:
    - appRoot: packages/frontend
      frontend:
          phases:
              preBuild:
                  commands:
                      - npm install -g pnpm
                      - pnpm install
              build:
                  commands:
                      - (curl -Ls https://cli.doppler.com/install.sh || wget -qO- https://cli.doppler.com/install.sh) | sh
                      - doppler run -- pnpm run build
          artifacts:
              baseDirectory: build
              files:
                  - '**/*'
          cache:
              paths:
                  - node_modules/**/*
    - appRoot: packages/client
      frontend:
          phases:
              preBuild:
                  commands:
                      - pnpm
              build:
                  commands:
                      - pnpm build
          artifacts:
              baseDirectory: dist
              files:
                  - '**/*'
          cache:
              paths:
                  - node_modules/**/*
